\chapter{Production on a single line}
\label{chap:lot-size:single-line}


\esgil{Vérifier la cohérence. \emph{Setup} désigne le lancement de la production (\ie un instant discret). \emph{Order of production} désigne le setup et la durée de production qui suit (\ie un intervalle).}


% \begin{itemize}
%   \item bibliographie
%   \item Flexibilité
%   \item Production on a single line
%   \item campagne de production ou batch de production
% \end{itemize}


As explained in \cref{sec:business-context:argon:pdp}, the objective is to reduce inventory.
In this chapter, we presented a model whose goal is to find the optimal cycle stocks.


\section{Deterministic settings}
\label{sec:lot-size:single-line:deterministic}

In this whole section, data are assumed deterministic.


\subsection{Motivations}
\label{sec:lot-size:single-line:deterministic:motivations}


Cycle stocks are the portion of inventory that decreases gradually as customers’ orders come in and that are replenished cyclically when suppliers’ orders are received.
Low cycle stocks contribute to globally decrease inventory but it requires a high flexibility of means of production.
At this level of decision, flexibility is fixed and industrial objective is to find the values of cycle stocks of each item which minimize the global inventory.


Many production systems are managed using $(r,\lot)$ policies or similar ones.
This kind of policies defines for each item a level $r$ and a quantity $\lot$ such that: when inventory level of item reaches level $r$, a quantity $\lot$ is produced.
A common variation uses cover-sizes.
Quantity $\lot$ is replaced by a time $\cover$ called \emph{cover-size}.
When inventory level of item $i$ reaches level $r$, quantity produced is the cumulative demand of the $\cover$ next units of time.
Both are used by industrials (and are equivalent when demand does not depend on time).


The problem described by Argon Consulting considers an assembly line producing a set $\REF$ of items over an infinite horizon.
%The capacity needed (in time units) to produce one unit of item $i$ is $\rate_i$.
The internal production time of item $i$ (\ie the number of item $i$ produced in one time unit) is $\rate_i$.
Inventory $\inventory_i$ of item $i$ must satisfy demand, known in advance.
Then it continuously decreases by $\demand_i<\rate_i$ units per time unit when there is no production and continuously increases by $\rate_i-\demand_i$ units per time unit when item $i$ is produced.


We call \emph{order of production} of an item $i$ an interval of time $[t_1,t_2]$ dedicated to the production of $i$ such that $t_1<t_2$ production starts at $t_1$ and stops at $t_2$.
We call \emph{production setup} or simply \emph{setup} the beginning of an order of production.
Order of production of item $i$ can be placed at any time, even simultaneously (like in~\cite{Ohno2001} where authors assume the immediate replenishment of the order with lead time).
However, the interval $\cover_i$ between two successive setups of a given item $i$ (\ie the cover) has to be the same over the infinite horizon.
%(It imposes that the solution is periodic for each item.)
Besides, the flexibility being modeled by a constraint and not by setup costs (see \cref{sec:business-context:argon:pdp}), in average over the infinite horizon, the number of setups per unit time for all items must be lower than $\nbsetups$.


For each item $i$, there is an initial inventory $s_i\bracket{0}\in\RR_+$.


Since inventory varies over times, the cycle stock is measured using its average value over an infinite horizon.
Storing one unit of item $i$ incurs a unit holding cost $\holding_i>0$ per unit time.
Objective is minimizing average cycle stock while satisfying every constraint.


\medskip


We will consider two versions of this problem.
\begin{itemize}
  \item The covers can be any nonnegative real numbers.
  \item The covers have to be inverses of integers.
\end{itemize}
In other words, since a cover is a time period, the production frequencies are unconstrained in the first version, while there are constrained to be integers in the second one. We qualify the first version of being {\em unconstrained} and the second of being {\em integer}.




\subsection{Bibliography}

\textbf{literature review}

\begin{itemize}
   \item \cite{Gayon2016} Continuous-review inventory models for single item
\end{itemize} 

Multi-item

\begin{itemize}
  \item \cite{Hadley1963} first to note that perhaps the most important real world constraints are budget restrictions on the amount that can be invested in inventory.
  \item \cite{Schrady1971} Minimization of total time-weighted shortage subject to inventory investment (holding cost) and to reorder workload. They use our formula to find a solution but does not prove it optimality.
  \item \cite{Daeschner1975} Model with limited number of reorder transactions to be considered in the present allocation.
  \item \cite{Ohno2001} Minimization of the holding cost, backorder cost and ordering cost subject to capacity constraints on the inventory.
\end{itemize}


\medskip

\textbf{Ordering}

\begin{itemize}
  \item \cite{Harris1913} Economic Order Quantity (in French: ``Formule de Wilson'' because it was extensively used by R. H. Wilson from 1934)
  \begin{itemize}
    \item single item
    \item cost structure: proportional holding cost, variable and fixed order cost
    \item stationary demand $\demand$
    \item average cost over infinite horizon
  \end{itemize}
  \item Time varying demand $\demand(t)$
  \begin{itemize}
    \item \cite{Resh1976,Donaldson1977} $\demand(t)=\alpha t+\gamma$ polynomial
    \item \cite{Barbosa1978} $\demand(t)=\alpha t^{\beta}$
    \item difficult in general
  \end{itemize}
\end{itemize}

Classical policy: Zero Inventory Ordering policy $(r,q)$ (Order quantity $q$ when current inventory is $r$)

\medskip

\textbf{Production}

\begin{itemize}
  \item Economic Production Quantity (extension of EOQ with limited production capacity) \cite{Taft1918}
  \begin{itemize}
    \item Limited production capacity
  \end{itemize}
\end{itemize}


\medskip

\esgil{complete bibliography}

\medskip


%\subsection{Models}

% The exact problem in which Argon Consulting was interested in is the following.

% We are given a set $\REF$ of products, which have to be produced over an infinite horizon. For each product $i\in\REF$, the demand rate $\demand_i$ is a fixed value known in advance and there is also a unitary holding cost $\holding_i$: given an inventory profile $\inventory_i\colon[0,\horizon]\rightarrow\RR_+$ (with all suitable assumptions) for product $r$, when there is no production, the dynamic of the inventory is $\frac{\diff}{\diff t}\inventory_i(t)=\demand_i$ and the total holding cost of product $r$ over the horizon is $\holding_i\int_0^{\horizon}\inventory_i(t)\diff t$.

% Order of production of $r$ can be placed at any time, and we assume that the production is instantaneous. However, the interval between two successive orders of a given product has to be the same over the whole horizon (this interval is the {\em cover} of product $r$). (It imposes that the solution is periodic for each product.) Order of production of several products can be placed simultaneously (like in~\cite{Ohno2001} where authors assume the immediate replenishment of the order with lead time), but the total number of times an order is placed per time unit (over all products) is upper bounded by a given quantity denoted by $\nbsetups$. The goal is to satisfy the demand, \ie, $\inventory_i(t)\geq 0$ almost everywhere for every product $r$, while minimizing the average cost.

% \esgil{Ordre de production périodique et doivent couvrir exactement la demande de la période.}

% We will consider two versions of this problem.
% \begin{itemize}
%   \item The covers can be any nonnegative real numbers.
%   \item The covers have to be inverses of integers.
% \end{itemize}
% In other words, since a cover is a time period, the production frequencies are unconstrained in the first version, while there are constrained to be integers in the second one. We qualify the first version of being {\em unconstrained} and the second of being {\em integer}.



% Our problem deals with a single production line which can produce a set $\REF$ of products. This ability, called \emph{flexibility}, enables to make several setups as shown in figure~\ref{fig:1}. The graphic shows the evolution of the inventory of three products depending on time. During some period, the line is used to produce one product but cannot be used during the same period for the others.

% \medskip

% \esgil{FIG 1: Graph with several products and several decreasing of demand and internal production time}

% \medskip


% The industrial goal is to find simple rules which enables to minimize the holding cost. Since randomness happens during the scheduling and cannot be seen at tactical level, the goal is not to find the optimal scheduling but to size the operations which will be scheduled. Thus, we are interested in sizing the \emph{cover} of products which is the time for which inventory of the product is positive and we neglect the production time. Figure~\ref{fig:1} can now be simplify in figure~\ref{fig:2}.

% \medskip


% \esgil{fig:1 without internal production time}

% \medskip




% In practice, comparing holding cost and setup cost is hard. As explain in Harris' model, they are different type of cost. However, in some industries like cosmetic where a clean up is needed to change the lotion or in pneumatic industry where new settings are needed to change the size of produced pneumatics, operational people can easily give the number of setups in a period. Our optimization problem can be rewrite in the minimization of the holding cost subject to limited number of setups.


% Like Harris, we formulate several hypothesis.
% \begin{itemize}
%   \item The demand $\demand_i$ of each product $r$ per time unit is constant over the whole period $\horizon$.
%   \item The cost of the inventory is proportional to his size and the company has no limit on the holding capacity.
%   \item The company has always enough raw material to ensure his production.
% \end{itemize}


% We use the following notations. $\REF$ is the set of products and $\nbsetups$ the number of possible setups during the whole horizon. For each product $i\in\REF$, let $\demand_i$ be the demand per time unit and $\holding_i$ be the unit holding cost. Since the demand is constant over time, we can use three set of variables: cover size $\cover_i$ of the product $r$, production frequency $\freq_i=\frac{1}{\cover_i}$ which is the number of time product $r$ is produced during the horizon or lot size $\lot_i = \demand_i\cover_i$ which is the quantity produced each time product $r$ is produced.



%\subsection{Deterministic model}

\subsection{Model with unconstrained frequencies}
\label{sec:lot-size:single-line:models:unconstraint}


%Using the average value of the inventory of each product over time, the optimization problem can be written as follow:

We claim that the following optimization problem is a correct model of the problem described in \cref{sec:lot-size:single-line:deterministic:motivations} in its unconstrained version:
\begin{subequations}\label{eq:lot-size:single-line:deterministic:unconstraint}
  \begin{align}
  \min\quad & \ds\sum_{i\in\REF} \frac{1}{2}\holding_i\tilde{\demand}_i\cover_i
  \label{eq:lot-size:single-line:deterministic:unconstraint:objective}
  \\
  \st\quad  & \ds\sum_{i\in\REF} \frac{1}{\cover_i} \le \nbsetups
  \label{eq:lot-size:single-line:deterministic:unconstraint:flexibility}
  \\
       & \cover_i > 0 && \forall i\in\REF,
  \label{eq:lot-size:single-line:deterministic:unconstraint:positivity}
  \end{align}
\end{subequations}
where $\tilde{\demand}_i=\bracket{1-\frac{\demand_i}{\rate_i}}\demand_i$ is the reduced value of the demand.

The correctness is however not necessarily immediate: note that model~\eqref{eq:lot-size:single-line:deterministic:unconstraint} assumes that optimal policy is \emph{Zero-Inventory-Ordering (ZIO)} and directly give the average values for objective and constraint.
We recall that a policy is said to be ZIO if an order occurs only if the inventory is zero.
\esgil{Citer la definition exacte.}
We state thus this fact, with a complete proof.


For each item $i$, let $\freq_i\bracket{t}$ be the number of setups during the interval $[0,t)$ and $\freq_i$ the average number of setups per time unit over the infinite horizon.
Let $t_i$ be the first production setup of item $i$.
Then, according to problem description in \cref{sec:lot-size:single-line:deterministic:motivations}, production setups occur at times $t_i+k\,\cover_i$ with $k\in\ZZ_+$.


\begin{prop}\label{prop:lot-size:single-line:models:average-setup}
For each item $i$, average number $\freq_i$ of setups per time unit over the infinite horizon is equal to $\frac{1}{\cover_i}$ where $\cover_i$ is the cover and flexibility constraint described in \cref{sec:lot-size:single-line:deterministic:motivations} can be written as
\begin{equation}
  \sum_{i\in\REF} \frac{1}{\cover_i} \le \nbsetups.
\end{equation}
\end{prop}


\begin{proof}
For a time $t>t_i$, the average number of setups per time unit during the interval $[0,t)$ is
$\frac{1}{t}\left\lfloor\frac{t-t_i}{\cover_i}\right\rfloor$
which converges to $\frac{1}{\cover_i}$ when $t$ goes to infinity.

\cref{eq:lot-size:single-line:deterministic:unconstraint:flexibility} of the flexibility constraint described in \cref{sec:lot-size:single-line:deterministic:motivations} immediately follows.
\end{proof}


Note that this formulation is independent of the first production setup $t_i$.
Then choice of $t_i$ is only constraint by positive inventory.


\begin{prop}\label{prop:lot-size:single-line:models:ZIO}
Optimal policy is Zero-Inventory-Ordering and its cost is given by
\begin{equation}
  \sum_{i\in\REF}\frac{1}{2}\holding_i\bracket{1-\frac{\demand_i}{\rate_i}}\demand_i\cover_i^*
\end{equation}
where $\cover_i^*$ is the cover of item $i$ in such a policy.
\end{prop}


\begin{proof}
Consider an admissible policy and let $\delta_i$ be the size of the order of production of item $i$.
By definition of the cover $\cover_i$, the produced quantity is exactly the demand for the next $\cover_i$ time unit.
Thus, we have $\rate_i\delta_i=\demand_i\cover_i$ and inventory level is the same at each production setup and is equal to $\inventory_i(0)-\demand_i t_i \ge 0$.
Cycle stock between $k^{th}$ and $\bracket{k+1}^{th}$ setup is given by
\begin{equation}
  S_{i,k}
  =
  \int_{t_i+k\cover_i}^{t_i+\bracket{k+1}\cover_i}\inventory_i(t)dt
  =
  \bracket{\inventory_i(0)-\demand_i t_i}\cover_i
  + \frac{1}{2}\bracket{1-\frac{\demand_i}{\rate_i}}\demand_i\cover_i^2.
\end{equation}
For each time $\horizon$, the average cycle stock is
\begin{equation}
  S_i\bracket{\horizon} = \frac{1}{\horizon} \int_0^{\horizon}\inventory_i(t)dt
\end{equation}
and we have the following inequalities.
\begin{equation}
  \frac{1}{\horizon} \int_0^{t_i}\inventory_i(t)dt
  + \frac{1}{\horizon} \sum_{k=0}^{\left\lfloor\frac{\horizon-t_i}{\cover_i}\right\rfloor} S_{i,k}
  \le
  S_i\bracket{\horizon}
  \le
  \frac{1}{\horizon} \int_0^{t_i}\inventory_i(t)dt
  + \frac{1}{\horizon} \sum_{k=0}^{\left\lceil\frac{\horizon-t_i}{\cover_i}\right\rceil} S_{i,k}
\end{equation}
Then, the average cycle stock on infinite horizon for item $i$ is
\begin{equation}
  \lim_{\horizon\rightarrow\infty} S_i\bracket{\horizon}
  =
  \inventory_i(0)-\demand_i t_i
  + \frac{1}{2}\bracket{1-\frac{\demand_i}{\rate_i}}\demand_i\cover_i.
\end{equation}
Thanks to \cref{prop:lot-size:single-line:models:average-setup}, this policy is admissible for each $(t_i)_i$ such that $\inventory_i(0)-\demand_i t_i\ge 0$.
In particular, for a given $\bracket{\cover_i}_i$, a ZIO policy (\ie such that $\inventory_i(0)=\demand_i t_i$) is admissible and cheaper which concludes the proof.
\end{proof}


Thanks to \cref{prop:lot-size:single-line:models:average-setup} and \cref{prop:lot-size:single-line:models:ZIO}, problem \eqref{eq:lot-size:single-line:deterministic:unconstraint} is a correctly models the unconstrained version of the problem described \cref{sec:lot-size:single-line:deterministic:motivations}.


Before giving the optimal policy, note that model simply adapts to case where production is considered instantaneous (\ie $\rate_i\rightarrow\infty$).
In this case, just use real demand $\demand_i$ instead of reduced demand $\bracket{1-\frac{\demand_i}{\rate_i}}\demand_i$.

% Then, if such a limit exists, we must have
% \begin{equation}
%   \limsup_{t\rightarrow\infty}\frac{1}{t} \sum_{i\in\REF}\freq_i\bracket{t}\le\nbsetups.
% \end{equation}


% \begin{proof}
% Scheme of proof:
% \begin{itemize}
%   \item expression of the constraint
%   \item ZIO policy
%   \item expression of the objective
% \end{itemize}
% \end{proof}

\begin{prop}
Problem~\eqref{eq:lot-size:single-line:deterministic:unconstraint} has a unique optimal solution $(\cover_i^*)_{i\in\REF}$, which provides the optimal cover values for the unconstrained version of the problem described \cref{sec:lot-size:single-line:deterministic:motivations}.
\end{prop}


\begin{proof}
Solving Problem~\eqref{eq:lot-size:single-line:deterministic:unconstraint} is straightforward using the Karush-Kuhn-Tucker condition since it is a convex problem and gives the unique solution
\begin{equation}
  \cover_i^*= \frac{\sum_{j\in\REF}\sqrt{\holding_j\tilde{\demand}_j}}{\nbsetups\sqrt{\holding_i\tilde{\demand}_i}}\qquad\forall i\in\REF
\end{equation}
with optimal cost $\frac{1}{2\nbsetups}\bracket{\sum_{i\in\REF}\sqrt{\holding_i\tilde{\demand_i}}}^2$.
\end{proof}


% Using the production frequencies $\freq_i=\frac{1}{\cover_i}$ of product $r$, we get the optimal frequencies:
% \begin{equation}
%   \freq_i^* = \frac{1}{\cover_i^*}
%             = \frac{\nbsetups\sqrt{\holding_i\demand_i}}{\sum_{s\in\REF}\sqrt{\holding_s\demand_s}}
%             \quad \forall i\in\REF,
% \end{equation}
% and the associated holding cost is $\frac{1}{2\nbsetups}\bracket{\sum_{i\in\REF}\sqrt{\holding_i\demand_i}}^2$.


% \esgil{Write the proof}



\subsection{Model with integer frequencies}


In some cases, it is easier for industrial to use integer frequencies.
As explained in \cref{sec:lot-size:single-line:models:unconstraint}, dealing with finite or infinite internal production time $\rate_i$ is very similar since, it is sufficient to use the demand $\demand_i$ or the reduced demand $\tilde{\demand}_i$ in problem \eqref{eq:lot-size:single-line:deterministic:unconstraint}.
Thus, we only write the case with infinite internal production time.
\begin{subequations}\label{eq:lot-size:single-line:deterministic:integer}
  \begin{align}
  \min\quad & \ds\sum_{i\in\REF} \frac{1}{2}\holding_i\demand_i\frac{1}{\freq_i}
  \label{eq:lot-size:single-line:deterministic:integer:objective}
  \\
  \st\quad  & \ds\sum_{i\in\REF} \freq_i \le \nbsetups
  \label{eq:lot-size:single-line:deterministic:integer:flexibility}
  \\
       & \freq_i \in \ZZ_+^* && \forall i\in\REF,
  \label{eq:lot-size:single-line:deterministic:integer:positivity}
  \end{align}
\end{subequations}
where $\freq_i$ is the average number of setups per time unit over the infinite horizon.


This formulation is a special case of the integer simple resource allocation problem:
\begin{equation}
  \max\crbracket{\sum_{i\in\REF} f_i\bracket{\freq_i} \Big| \sum_{i\in\REF}\freq_i=\nbsetups,\quad\freq\in \ZZ_+^*}
\end{equation}
where the $f_i$ are concave.
\esgil{Check the definition of the problem}

The fastest algorithm known has a $O\bracket{\card{\REF}\log{\frac{\nbsetups}{\card{\REF}}}}$ running time and was proposed by \cite{Frederickson1982} and then simplified by \cite{Hochbaum1994}. Implementation of these algorithms is not easy that is why dynamic programming might be used even if its complexity is only $O\bracket{\card{\REF}\nbsetups^2}$ which is pseudo-polynomial.



\section{Stochastic settings}


\subsection{Motivations}
\label{sec:lot-size:single-line:stochastic:motivations}


As in \cref{sec:lot-size:single-line:deterministic}, cycle stocks are managed using $(r,\lot)$ policies or similar one.
However, in real life, many parameters are not known in advance.
An obvious example is demand which can changes due to forecast errors, marketing promotions, passing fads.
Randomness can also comes from production means.
Failures, holidays or strikes can affect internal production time.


Production means are assumed reliable and we only consider randomness on demand.
Thus, the assembly line still produces a set $\REF$ of items over an infinite horizon.
The internal production time of item $i$ is $\rate_i$.
Inventory $\va\inventory_i$ of item $i$ must satisfy random demand.
Then it continuously decreases by $\va\demand_i<\rate_i$ units per time unit when there is no production and continuously increases by $\rate_i-\va\demand_i$ units per time unit when item $i$ is produced.
Note that inventory $\va\inventory_i$ and demand $\va\demand_i$ are in bold to indicate that they are random.
Moreover, $\va\demand_i$ is assumed to be almost surely lower than $\rate_i$.


Order of production of item $i$ can be placed at any time, even simultaneously and cover $\cover_i$ of item $i$ has to be the same over the infinite horizon.
%(It imposes that the solution is periodic for each item.)
Flexibility is still modeled by a constraint.
In average over the infinite horizon, the number of setups per unit time for all items must be lower than $\nbsetups$.


For each item $i$, there is an initial inventory $s_i\bracket{0}\in\RR_+$.


Storing one unit of item $i$ incurs a unit holding cost $\holding_i>0$ per unit time.
Objective is minimizing the expectation of average cycle stock while satisfying every constraint.
Note that the covers are the decision variables and are deterministic.


\subsection{Bibliography}

Source of randomness:
\begin{itemize}
  \item customer demand
  \item manufacturing time (internal production time)
  \item delivery lead time
\end{itemize}

Randomness was handled by probability (most cases) but also with fuzzy set theory (\eg \cite{Park1987,Lee1999,Wang2007} for extensions of the EOQ and \cite{Ziukov2015} for a complete review of the extensions of EOP, EPQ, Joint Economic Lot Sizing models). In what follows, we focus on randomness represented by probability.

Literature often include backorder costs!

\medskip

\textbf{Ordering}

One period:
\begin{itemize}
  \item News-vendor problem \cite{Edgeworth88,Arrow1951}
\end{itemize}

Continuous-review:
\begin{itemize}
  \item adaptation of (r,q) policies with EOQ taking into account random demand during lead-time \cite{Gallego1998}
\end{itemize}

\medskip

\textbf{Production}




\esgil{Complete bibliography}



\subsection{Model}


We claim that the following optimization problem is a correct model of the problem described in \cref{sec:lot-size:single-line:stochastic:motivations}.
\begin{subequations}\label{eq:lot-size:single-line:stochastic:unconstraint}
  \begin{align}
  \min\quad & \ds\sum_{i\in\REF} \frac{1}{2}\holding_i\tilde{\tilde{\demand}}_i\cover_i
  \label{eq:lot-size:single-line:stochastic:unconstraint:objective}
  \\
  \st\quad  & \ds\sum_{i\in\REF} \frac{1}{\cover_i} \le \nbsetups
  \label{eq:lot-size:single-line:stochastic:unconstraint:flexibility}
  \\
       & \cover_i > 0 && \forall i\in\REF,
  \label{eq:lot-size:single-line:stochastic:unconstraint:positivity}
  \end{align}
\end{subequations}
where $\tilde{\tilde{\demand}}_i=\bracket{1-\frac{\espe\sqbracket{\va\demand_i}}{\rate_i}}\espe\sqbracket{\va\demand_i} - \frac{\vari\sqbracket{\va\demand_i}}{\rate_i}$ is the reduced value of the demand in stochastic case.


% There are many sources of randomness. Raw materials can be out of stock when production is supposed to begin, level of demand is uncertain, there can be variability on the internal production time, etc. We only consider variability of demand. We do an optimization without recourse and the objective is to minimize the expectation of the holding costs which is:
% \begin{equation}
%   \espe\sqbracket{\sum_{i\in\REF} \frac{1}{2}\holding_i\va\demand_i\bracket{1-\internal_i\va\demand_i}\cover_i}
%   = 
%   \sum_{i\in\REF} \frac{1}{2}\holding_i\bracket{\espe\sqbracket{\va\demand_i}\bracket{1-\internal_i\espe\sqbracket{\va\demand_i}}-\internal_i\vari\sqbracket{\va\demand_i}}\cover_i
% \end{equation}


Assuming that this formulation is correct, adaption of results of deterministic cases (unconstrained and integer frequencies) to stochastic cases is straightforward.
Moreover, when the only randomness comes from the demand, we also show that the optimal solution is completely determine by the expectation and the variance of each of the demand $\va\demand_i$.


\esgil{Complete the correctness of the model.}



\section{Numerical experiments}

\begin{itemize}
  \item Numerical experiments
  \item Lien avec la formule de Wilson
\end{itemize}


\subsection{Concluding remarks}



% A natural extension takes into account the internal production time $\internal_i$ which is the time needed to produce one unit of product $r$. In this case, the production is not instantaneous and during the production phase of $r$, the increase of the inventory is $\frac{1}{\internal_i}-\demand_i$ per time unit. Thus, the average value of the inventory of product $r$ is equal to $\frac{1}{2}\holding_i\demand_i\bracket{1-\internal_i\demand_i}$. Setting $\holding_i'=\holding_i\bracket{1-\internal_i\demand_i}$, we get the optimal frequencies:
% \begin{equation}
%   \freq_i^* = \frac{1}{\cover_i^*}
%             = \frac{\nbsetups\sqrt{\holding_i\demand_i\bracket{1-\internal_i\demand_i}}}{\sum_{s\in\REF}\sqrt{\holding_s\demand_s\bracket{1-\internal_s\demand_s}}}
%             \quad \forall i\in\REF,
% \end{equation}
% and the associated holding cost is $\frac{1}{2\nbsetups}\bracket{\sum_{i\in\REF}\sqrt{\holding_i\demand_i\bracket{1-\internal_i\demand_i}}}^2$.

