%!TEX root=../../thesis_ESG.tex
\chapter{Numerical experiments}
\label{chap:PDP:numerical-experiments}


To test the efficiency of our approach, we retrieve datasets from Argon Consulting's clients.
Then, we simulate the sequence of production periods and emulate the behavior of people making production planning decisions to compare their consequences to the ones of decisions taken by our approach.
We empirically show that the method we propose lead to improvement in inventory management.


\section{Simulation}


In this chapter, each method used to compute a production planning is called an \emph{heuristic} since it cannot guarantee to reach the optimum.
Moreover, we are not able to prove than one heuristic is theoretically better than another.
Thus, in order to compare their efficiency, we use simulations.


The simulation emulates the behavior of people making production planning facing uncertainty.
First, we define assembly line data and a forecast demand which is a function of the current period and of the past outcomes.
Then, we choose a heuristic to compute the production planning.


We use a repeated approach starting at period $t=1$.
For each period $t$, we observe the current inventory level of each item, \ie the inventory at the end of the previous period.
Using the forecast demand function and the chosen heuristic, we compute the production planing and fix the decision for the current period $t$.
In real life, it correspond to starting the production for the current period without deviating from the planning.
At the end of the period, we observe the demand outcome for period $t$ and update the inventory level.


At the end of the simulation, we get several \emph{Key Performance Indicators (KPI)} measuring the efficiency of the heuristic.


A scheme of a typical run of the simulation is given in \cref{fig:simulator}.

\begin{figure}[h]
  \centering
  \includegraphics{main/PDP/images/simulator.tikz}
  \caption{Scheme of the run of the simulation}
  \label{fig:simulator}
\end{figure}


C++11 has been chosen for the implementations and Gurobi 6.5.1~\citet{gurobi} was used to solve the model on a PC with 8 processor Intel\textregistered\ Xeon\texttrademark\ E5-2667 @ 3.30GHz and 48Go RAM.




\section{Heuristics}
\label{sec:PDP:numerical-experiments:heuristics}


Our heuristic consists in solving (2SA-$m$) as defined in Problem~\eqref{eq:Uniform-CLSP-BS-2SA-m:backorder} at the beginning of each period $t$.
We compare it with three other heuristics:
\begin{itemize}
  \item deterministic approximation,
  \item lot-size,
  \item cover-size.
\end{itemize}


The first heuristic is the deterministic version of Problem~\eqref{eq:Uniform-CLSP-BS:backorder}, where the random demand is replaced by its expectation.
Note that it is not the CLSP-BS described in \cref{chap:PDP:deterministic} since there are backorder costs.
When backorder cost are not given by the client, we used the method described in \cref{sec:PDP:stochastic:model:backorder} to compute them.


The second one, the {\em lot-size heuristic}, consists in determining before the first week once and for all a value $\ell_i^*$ for each item $i\in\REF$.
At time $t$, if the inventory of item $i$ is below a precomputed safety stock (see \cref{eq:PDP:numerical-experiments:safety-stock}), the quantity $\quantity_t^i$ is chosen so that the inventory of item $i$ exceeds the safety stock of exactly $\ell_i^*$.
Indeed, as shown in \cref{fig:lot-size-heuristic}, the inventory level at the end of a period may be lower than the safety stock.
In case of capacity issues, the production is postponed and thus backorder costs appear.
In addition, if some capacity issues are easily anticipated, the production of an item $i$ can be activated even if the inventory is not below the safety stock.

\begin{figure}[h]
  \centering
  \subfloat[lot-size]
  {
    \includegraphics[width=\textwidth]{main/PDP/images/lot-size_heuristic.tikz}
    %\esgil{TODO: uncomment figure}
    \label{fig:lot-size-heuristic}
  }
  \\
  \subfloat[Cover-size]
  {
    \includegraphics[width=\textwidth]{main/PDP/images/cover-size_heuristic.tikz}
    %\esgil{TODO: uncomment figure}
    \label{fig:cover-size-heuristic}
  }
  \caption{Computation of produced quantities using lot-size and cover-size heuristics}
  \label{fig:lot-and-cover-size-heuristics}
\end{figure}


The third one, the {\em cover-size heuristic}, is almost the same, but instead of precomputing a fixed quantity for each item, a duration $\tau_i^*$ is fixed before the first week.
When the inventory of item $i$ is below the safety stock, the quantity $\quantity_t^i$ is computed so that the inventory of item $i$ exceeds the safety stock of the expected demand for the next $\tau_i^*$ weeks.
An example is given on \cref{fig:cover-size-heuristic}.



The values $\ell_i^*$ and $\tau_i^*$ are determined using results of \cref{chap:lot-size:single-line}.
$(\tau_i^*)_{i\in\REF}$ is actually chosen to be the optimal solution to Program~\eqref{eq:cont-rev-det}, which somehow considers the problem at a ``macroscopic'' level
%(Similar convex programs in the same context have been considered in the literature; see~\citet{Ziegler1982} for example.)
where the demand $\demand^i$ is chosen equal to $\espe\sqbracket{\sum_{t=1}^{\horizon}\va d_t^i}$.

For each item $i$, the parameter $\ell_i^*$ of the lot-size heuristic is then set to $\demand^i\tau_i^*$.


There is no universal formula for safety stocks $\bracket{\safety^i}_i$.
Thus we turn to the formula used in practice by most of Argon Consulting's clients (see \citet[Chapter 11]{Arnold2007}) where the underlying model assumes that demand has a Gaussian distribution.
Production being decided at the beginning of the period and the demand being revealed at the end of the period, the lead time is one period (and is certain).
Thus, for each item $i$, the safety stock used to reach cycle service level $\alpha$ is
\begin{equation}\label{eq:PDP:numerical-experiments:safety-stock}
  \safety^i = z_{\alpha} \sqrt{\vari\sqbracket{\va\demand^i}}
\end{equation}
where $\va\demand^i=\sum_{t=1}^{\horizon}\va\demand_t^i$ and $z_{\alpha}$ is the inverse distribution function of a standard normal distribution with cumulative probability $\alpha$.
When fill rate service level $\servicelvl$ is used, an abacus gives the coefficient $k_{\servicelvl}$ which must be used instead of $z_{\alpha}$.


\medskip

The cover-size heuristic adapts the production to the realization of the demand, contrary to the lot-size heuristic.
According to Argon Consulting, it makes the cover-size heuristic more suitable for situations with low short term volatility of demand or for overcapacitated lines, while the lot-size heuristic is expected to behave better with high short term volatility of demand or for undercapacitated lines.


Note that the backorder costs are not taken into account at all for determining the values of the parameters $\ell_i^*$ and $\tau_i^*$.
But playing with safety stocks allows to prevent too large backorder costs.
However, in real life it is usually the other way round: the company does not associate costs to backorder and aims at keeping the total amount of unsatisfied demand below some predetermined level.




\section{Instances and probabilistic model}
\label{sec:PDP:numerical-experiments:instances}


\subsection{Datasets}
\label{sec:PDP:numerical-experiments:historical-data}

The instances used are realistic and have been provided by a client of Argon Consulting.
The client gave the data of seven assembly lines and the demand for each week over an full quarter.
The horizon $\horizon$ is the typical one used in practice by this client, namely $\horizon=13$ weeks.

The historical demand are denoted by $\bar{\demand}_t^i$.

The initial inventory is set to $s_0^i=\frac{1}{3}(\bar{\demand}_1^i+\bar{\demand}_2^i+\bar{\demand}_3^i)$.

The other parameters are provided in \cref{tab:pdp:instances-characterisitcs}.
%In particular, for each value of $v$, we have considered three possible values of the unit backorder cost $\backorder$, which have been determined following a procedure described in Section~\cref{sec:service}. At the moment, we do not discuss further these values and take them as part of the input, as required by the problem formulation.
The parameter $C$ is the capacity of the line before normalization.
(Recall that the problem and the model have been formulated in \cref{sec:PDP:stochastic:model} after normalization.)
In the column $\tilde{\holding}^i$, we indicate the range of the holding costs before normalization.
We obtain the $\holding^i$'s by dividing these costs by $C$ since internal production times $\rate^i$ are unitary.

We also add the loading indicator $\kappa_t$ at period $t$ defined as:
\begin{equation}
  \kappa_t = \frac{\sum_{i\in\REF} \bracket{\sum_{t'=1}^{t} \bar{\demand}_{t'}^i}-\inventory_0^i}{ \sum_{t'=1}^{t} \capacity_{t'}}
\end{equation}
It is the ratio of cumulative forecast demand up to period $t$ minus the initial inventory over cumulative capacity up to period $t$.
If there were no flexibility constraints and if the holding costs were not an issue, then for a period $t$, $\kappa_t \le 100\%$ implies that it is possible to supply the whole demand.
As shown in \cref{tab:pdp:instances-characterisitcs}, the lines $L_0$, $L_1$, $L_2$, $L_3$ and $L_4$ experience overcapacity: the loading indicator is smaller than $100\%$.
The lines $L_5$ and $L_6$ experience undercapacity: the loading indicator is larger than $100\%$ at some periods.

\begin{table}[ht]
\begin{center}
\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}lrrrrrrr@{\extracolsep{\fill}}}
\hline
Instances &
\multicolumn{7}{c}{Instance characteristics}
\\\cline{2-8}
\\
& $\card{\REF}$
& $\max(\bar{\demand}_t^i)$
& \multicolumn{1}{c}{$\capacity$}
& \multicolumn{1}{c}{$\nbsetups$}
& \multicolumn{1}{c}{$\tilde{\holding}^i$}
& \multicolumn{1}{c}{$\max\bracket{\kappa_t}$}
& \multicolumn{1}{c}{$\kappa_{\horizon}$}
\\\hline
$L_0$ & $21$ & $3780$ & $8518$ & $7$ & $45$--$88$ & $91\%$ & $74\%$
\\
$L_1$ & $30$ & $4122$ & $13326$ & $12$ & $52$--$82$ & $66\%$ & $52\%$
\\
$L_2$ & $21$ & $4992$ & $10562$ & $7$ & $35$--$61$ & $61\%$ & $61\%$
\\
$L_3$ & $13$ & $6220$ & $10394$ & $5$ & $22$--$30$ & $80\%$ & $65\%$
\\
$L_4$ & $18$ & $10584$ & $62164$ & $8$ & $12$--$14$ & $40\%$ & $35\%$
\\
$L_5$ & $12$ & $11772$ & $7902$ & $6$ & $15$--$17$ & $126\%$ & $98\%$
\\
$L_6$ & $22$ & $8640$ & $13299$ & $8$ & $16$--$23$ & $118\%$ & $98\%$
\\\hline
\end{tabular*}
\caption{Instance characteristics}
\label{tab:pdp:instances-characterisitcs}
\end{center}
\end{table}

The number $m$ of scenarios used to solve (2SA-$m$) is fixed to $20$, determined by preliminary experiments showing that it is a good trade-off between accuracy and tractability.
The time limit of the solver has been set to $120$ seconds.




\subsection{Demand distribution}
\label{sec:PDP:numerical-experiments:drawing-realization-of-demand}


For the sake of simplicity, in this section, we use index $k\in\range{K}$ to represent a pair $(t,i)\in\range{\horizon}\times\REF$.
We choose to model the distribution of demand $\bracket{\tilde{\va\demand}_1,\ldots,\tilde{\va\demand}_K}$ using the \distrib distribution defined as follow.


Let $\gamma\in\bracket{0,1}$ and let $\tilde{\demand}_1,\ldots,\tilde{\demand}_K$ be $K$ positive real numbers. 
We define the \distrib distribution of order $K$, denoted by $\cD\bracket{\gamma,\tilde{\demand}_1,\ldots,\tilde{\demand}_K}$, to be the probability distribution on $\RR_+^K$ such that $\bracket{\tilde{\va\demand}_1,\ldots,\tilde{\va\demand}_K}\sim\cD\bracket{\gamma,\tilde{\demand}_1,\ldots,\tilde{\demand}_K}$ if 
\begin{equation}
  \frac{1}{\tilde{\demand}_0}\bracket{\tilde{\va\demand}_1,\ldots,\tilde{\va\demand}_K}\sim\Dir\bracket{\alpha_1,\ldots,\alpha_K}
\end{equation}
with $\tilde{\demand}_0=\sum_{k=1}^K\tilde{\demand}_k$, $\alpha_0=\frac{1}{\gamma^2}-1$ and $\alpha_k=\frac{\tilde{\demand}_k}{\tilde{\demand}_0}\alpha_0$, for each $k\in\range{K}$.
\esgil{Mettre dans 7.3}
(We remind that $\Dir\bracket{\alpha_1,\ldots,\alpha_K}$ designates the Dirichlet distribution and recall its definition and the main results in \cref{sec:reminders:gamma-and-dirichlet-distributions}.)


Thus, the \distrib distribution has the properties given is \cref{prop:demand-distribution:properties}.


\begin{prop}\label{prop:demand-distribution:properties}
Let $\gamma$ be a real number in $\bracket{0,1}$ and let $\tilde{\demand}_1,\ldots,\tilde{\demand}_K$ be $K$ positive number (with $K\ge2$).
Let $\bracket{\va\demand_1,\ldots,\va\demand_K}$ be a random vector with a \distrib distribution $\cD\bracket{\gamma,\tilde{\demand}_1,\ldots,\tilde{\demand}_K}$.
Then, the following properties holds.
\begin{enumerate}
  \item\label{enum:PDP:random-demand-property:expectation}
  Expectation of $\va\demand_k$ is equal to
  \begin{equation}
    e_k = \espe\sqbracket{\va\demand_k} = \tilde{\demand}_k\qquad\forall k\in\range{K}.
  \end{equation}
  \item\label{enum:PDP:random-demand-property:variance}
  Variance of $\va\demand_k$ is equal to
  \begin{equation}\label{eq:PDP:numerical-experiments:demand:variance}
    (\sigma_k)^2=\vari\sqbracket{\va\demand_k}=\gamma\,\tilde{\demand}_k\bracket{\tilde{\demand}_0-\tilde{\demand}_k}\qquad\forall k\in\range{K}.
  \end{equation}
  \item\label{enum:PDP:random-demand-property:constant-volume}
  Sum of components of the vector $\bracket{\va\demand_1,\ldots,\va\demand_K}$ does not depend on the realization and is equal to
  \begin{equation}
    \sum_{k=1}^{K}\va\demand_k = \tilde{\demand}_0\qquad\mbox{almost surely.}
  \end{equation}
  \item\label{enum:PDP:random-demand-property:past-conditional}
  The \distrib\ distribution keeps the same properties conditionally to the past realizations.
  More formally, let $m$ be an integer in $\range[1]{k-1}$. We denote $\va\demand_{(1)}=\bracket{\va\demand_1,\ldots,\va\demand_m}$, $\va\demand_{(2)}=\bracket{\va\demand_{m+1},\ldots,\va\demand_K}$ and $\demand_{(1)}=\bracket{\demand_1,\ldots,\demand_m}$ a fixed realization of $\va\demand_{(1)}$.
  Then, $\bracket{\va\demand_{(2)}|\va\demand_{(1)}=\demand_{(1)}}$ has a \distrib distribution $\cD\bracket{\gamma',\tilde{\demand}_{m+1},\ldots,\tilde{\demand}_K}$
  where $\gamma'$ is the unique positive solution of
  \begin{equation}\label{eq:PDP:random-demand-property:past-conditional:gamma}
    \frac{1}{\gamma'^2}-1 = \bracket{\frac{1}{\gamma^2}-1}\bracket{1-\frac{1^T\demand_{(1)}}{\tilde{\demand}_0}}
  \end{equation}
  where $1^T$ is the vector with length $m$ and all entries equal to 1. 
\end{enumerate}
\end{prop}


The parameters of the \distrib distribution used to generate demand are the historical forecast demand $\bar{\demand}_t^i$ for the $\tilde{\demand}_k$ and $\gamma$ is set equal to
\begin{equation}\label{eq:PDP:gamma-from-volatility}
  \gamma
  =
  v\frac
  {\sum_{k=1}^K\sqrt{\frac{\tilde{\demand}_0}{\bar{\demand_k}}-1}}
  {\sum_{k=1}^K\bracket{\frac{\tilde{\demand}_0}{\bar{\demand_k}}-1}}.
\end{equation}
The parameter $\gamma$ is defined from another parameter $v$ which we call \emph{volatility} and whose interpretation is easier.
Volatility gives the ratio between standard deviation and expectation of a random variable.
Defining $\gamma$ as in \cref{eq:PDP:gamma-from-volatility} enables the volatility of each demand to be close to $v$ as well as possible and is justified in \cref{sec:PDP:numerical-experiments:instances:fitting-parameters}.


Using \distrib distribution has many advantages.
First, \cref{enum:PDP:random-demand-property:expectation} ensures that demand expectation is equal to the historical forecast demand and \cref{enum:PDP:random-demand-property:constant-volume} ensures that, as explained in \cref{chap:business-context}, total volume $\sum_{t,i}\va\demand_t^i$ of the forecast demand is constant over every possible outcomes.
Second, \cref{enum:PDP:random-demand-property:past-conditional} ensures that demand distribution keeps its properties when part of demand is revealed.


Moreover, random variables with a \distrib\ distribution can be easily generated using \cref{proc:demand:initial-sampling} since most of modern programming languages has a generator of gamma distributed variables.


\begin{proc}\label{proc:demand:initial-sampling}
\emph{Generator of \distrib\ distribution $\cD\bracket{\gamma,\tilde{\demand}_1,\ldots,\tilde{\demand}_K}$}

\textbf{Step 1.} \emph{Initialize the procedure.}

Set $\tilde{\demand}_0 = \sum_{k=1}^K\tilde{\demand}_k$ and $\alpha_0 = \frac{1}{\gamma^2}-1$ and for $k=1,\ldots,K$, set $\alpha_k=\frac{\tilde{\demand}_k}{\tilde{\demand}_0}\alpha_0$.

\textbf{Step 2.} \emph{Generate Gamma realizations.}

For $k=1,\ldots,K$, draw a number $y_k$ from gamma distribution $\Gamma\bracket{\alpha_k,1}$.

\textbf{Step 3.} \emph{Normalize the realization.}

For $k=1,\ldots,K$, set $x_k=\frac{y_k}{\sum_{\ell=1}^K y_{\ell}}$.

\textbf{Step 4.} \emph{Return a sample of the \distrib\ distribution $\cD\bracket{\gamma,\tilde{\demand}_1,\ldots,\tilde{\demand}_K}$.}

For $k=1,\ldots,K$, set $d_k = x_k \tilde{\demand}_0$.
\end{proc}


Finally, \cref{proc:demand:initial-sampling} and \cref{enum:PDP:random-demand-property:past-conditional} of \cref{prop:demand-distribution:properties} enables to easily generate a realization of the demand when part of the demand is already revealed.



\section{Use of $K$-means algorithm}
\label{sec:PDP:numerical-experiments:k-means}


As said in \cref{sec:PDP:numerical-experiments:historical-data}, we use a small number of scenarios to represent every possible outcomes.
Thus, using only \cref{proc:demand:initial-sampling} gives results which may be very dependent of the generating scenarios.
In this section, we propose to use a $K$-means algorithm on a bigger set of scenarios to get a small set of representative scenarios.


We refer to \citet[Chapter 14]{Hastie2009} for a detailed presentation of the method.
Roughly, $K$-means clustering aims at partitioning $n$ observations into $K$ clusters in which each observation belongs to the cluster with the nearest mean.
The mean of each cluster can be used as a prototype (\ie a representative element) of the cluster.


$K$-means algorithm is easy to implement but have some drawbacks.
First, it uses Euclidean distance as a metric and variance is used to measure cluster scatter.
In some cases, other distances might be more relevant.
Second, the number of clusters $K$ is an input parameter.
Thus, an inappropriate choice of $K$ may yield poor results.
Last, results depend of the initialization of the first $K$ prototypes and may lead algorithm to converge to local optimum.
Some variations of $K$-means algorithms exist to deal with these points (see \citet{Jain2010} for a review of $K$-means algorithm and its extensions).


\medskip


For lack of time, we do not yet implemented $K$-mean algorithm.
However, our utilization would be basic and would have the following structure.
We would first use \cref{proc:demand:initial-sampling} to generate a sample of $M$ scenarios which can be seen as real vectors of $\RR^{\horizon\times\REF}$.
Then, since the number of scenarios that can be used in (2SA-$m$) is bounded due to the computer performance, we would initialize $K$ with $m=20$.
Thus, our set of representative scenarios would be composed of the $K$ prototypes of each cluster and the probability of each one is equal to the number of scenarios in its cluster divided by $M$.



\section{Numerical results}
\label{sec:PDP:numerical-experiments:numerical-results}


We run tests on lines described in \cref{tab:pdp:instances-characterisitcs}.
Complete tables of results are given in \cref{chap:appendix:pdp:numerical-experiments} and the results for line $L_1$ is given in \cref{tab:pdp:results:line-1}.
(We choose line $L_1$ because it not a line that suffer undercapacity like $L_5$ and $L_6$ neither a line that is clearly overcapacitated like $L_4$.)


The table is composed as follow.
In the column \emph{Input}, we give the characteristic of inputs.
The sub-column \emph{Vol.} gives the volatility of the demand as defined in \cref{sec:PDP:numerical-experiments:drawing-realization-of-demand}.
The sub-column \emph{Strategy} gives the strategy used to make production decisions (see \cref{sec:PDP:numerical-experiments:heuristics}).
The abbreviation \emph{det} stands for the deterministic heuristic, \emph{sto} for (2SA-$m$) heuristic, \emph{cover} for cover-size and \emph{lot} for lot-size.
Finally, the sub-column \emph{Service} gives the service level used to compute backorder costs as explained in \cref{sec:PDP:stochastic:model:backorder}.


The output are composed of the following KPI.
They are all an average over the 30 runs of the simulation.
In the column \emph{Obj.}, we write the objective value \cref{eq:Uniform-CLSP-BS-2SA-m:backorder:objective} of the solution found by the heuristic (in k\euro{}).


The column \emph{Inventory}, we give several KPI relative to stocks.
The sub-column \emph{Av.} gives the average of the positive part of the inventory over periods, \ie
\begin{equation}
  \left<\inventory\right>_{\horizon} = \frac{1}{\horizon}\sum_{t=1}^{\horizon}\sum_{i\in\REF} \bracket{\holding^i\inventory_t^i}^+.
\end{equation}
The sub-column \emph{Max} gives the maximum of the positive part of the inventory over periods, \ie
\begin{equation}
  \max_{\horizon}\bracket{\inventory} = \max_{t\in\range{\horizon}}\bracket{\sum_{i\in\REF} \bracket{\holding^i\inventory_t^i}^+}.
\end{equation}
The sub-column \emph{Cover} gives the average cover-size of items, \ie the average number of periods covered when a production occurred.
This KPI is taken on average over items and each item is weighted by its holding cost.
For each item $i$, denoting by $\cT^i$ the subset of $\range{\horizon}$ of periods where item $i$ is produced, the KPI is computed by
\begin{equation}\label{eq:pdp:numerical-experiments:KPI:cover}
  \left<\cover\right>_{\REF}
  = \sum_{i\in\REF} \frac{w^i}{\card{\cT^i}}\sum_{t\in\cT^i} \frac{\quantity_t^i}{\left<\bar{\demand}^i\right>_{\horizon}}
  \quad\mbox{where}\quad
  w^i=\frac{\holding^i}{\sum_{j\in\REF}\holding^j}
  \quad\mbox{and}\quad
  \left<\bar{\demand}^i\right>_{\horizon}=\frac{1}{\horizon}\sum_{t=1}^{\horizon} \bar{\demand_t^i}.
\end{equation}


The column \emph{Service} gives the KPI relative to service level with the two classical measure.
The sub-column \emph{Fill rate} gives the average fill rate service level of items.
This KPI is taken on average over items and each item is weighted by its holding cost.
It is given by
\begin{equation}\label{eq:pdp:numerical-experiments:KPI:fill-rate-service-level}
  \left<\beta\right>_{\REF} = \sum_{i\in\REF} w^i \frac{\sum_{t=1}^{\horizon}\min\bracket{\bracket{\inventory_{t-1}^i}^++\quantity_t^i,\ \demand_t^i}}{\sum_{t=1}^{\horizon}\demand_t^i}
  \quad\mbox{where}\quad
  w^i=\frac{\holding^i}{\sum_{j\in\REF}\holding^j}.
\end{equation}
The sub-column \emph{Cycle} give the average cycle service level of items.
This KPI is taken on average over items and each item is weighted by its holding cost.
It is given by
\begin{equation}\label{eq:pdp:numerical-experiments:KPI:cycle-service-level}
  \left<\alpha\right>_{\REF} = \sum_{i\in\REF} w^i\frac{\sum_{t=1}^{\horizon} y_t^i}{\horizon}
  \quad\mbox{where}\quad
  w^i=\frac{\holding^i}{\sum_{j\in\REF}\holding^j}
  \quad\mbox{and}\quad
  y_t^i =
  \left\{
  \begin{array}{ll}
  1 & \mbox{if}\ \bracket{\inventory_{t-1}^i}^++\quantity_t^i\ge\demand_t^i \\
  0 & \mbox{otherwise}.
  \end{array}
  \right.
\end{equation}
Note that these two KPI give priority to satisfy current demand rather than backorder.


In the column \emph{Workload}, we compute the average workload of the assembly line.
This KPI is taken on average over periods.
It is given by
\begin{equation}
  \left<\mbox{Workload}\right>_{\horizon} = \frac{1}{\horizon} \sum_{t=1}^{\horizon} \frac{\sum_{i\in\REF} \quantity_t^i}{\capacity}.
\end{equation}


In the column \emph{Flex.}, we compute the average number of setups used on the assembly line.
This KPI is taken on average over periods.
It is given by
\begin{equation}
  \left<\mbox{Flexibility}\right>_{\horizon} = \frac{1}{\horizon} \sum_{t=1}^{\horizon} \frac{\sum_{i\in\REF} \setup_t^i}{\nbsetups}.
\end{equation}


\begin{table}[!ht]
\input{main/PDP/tables/line_1.tex}
\caption{Results for $L_1$}
\label{tab:pdp:results:line-1}
\end{table}


\cref{tab:pdp:results:line-1} and the others presented in \cref{chap:appendix:pdp:numerical-experiments} first show that best objective values for the problem is always reach by 2SA-$m$ heuristic.
Then deterministic heuristic also gives good objective value.
On the other hand, objective value returned by lot-size and cover-size heuristics are about 10 times greater than objective value returned by 2SA-$m$ heuristic.
About real inventory, we see that it represents the main part of the objective value for each heuristic.
Naturally, the average cover-sizes for each item are greater for lot-size and cover-size heuristics than for deterministic and 2SA-$m$ heuristics.


Backorder is strongly linked to fill rate service level.
As expected for strategies with such huge inventory, lot-size and cover-size heuristic have the best fill rate service level.
However, it is the same for any value of the tested desired service level.
On the other hand, deterministic and 2SA-$m$ heuristic adapt to the desired service level but they are too optimistic about their ability to satisfied uncertain demand.


By staring at the values of the backorder cost, we can see that the values computed by method proposed in \cref{sec:PDP:numerical-experiments:drawing-realization-of-demand} are very small especially for small desired service level like 85\%.
Thus, the method to compute the backorder is too optimistic and must be improved.
A simple way might be to skew the method.
A more sophisticated one might be to use extensions of the news-vendor problem like the multi-stage extension.


Comparing results between undercapacitated lines ($L_0$ to $L_4$) and overcapacitated lines ($L_5$ and $L_6$) does not show clear difference on the behaviors of the heuristics.
However, we simply see that the GAP between the different KPI is smaller in undercapacitated case than in overcapacitated case.




% \cref{tab:pdp:results:line-1} and the others presented in \cref{chap:appendix:pdp:numerical-experiments} first show that best objective values for the problem is not reach by (2SA-$m$) heuristic.
% In many case, the value found by (2SA-$m$) heuristic is far from the values obtained by other heuristics.
% However, in general, we see than (2SA-$m$) is the heuristic that is the closest from the fill rate service level objective.
% Lot-size heuristic also gives quite good results on fill rate service level but it generates a lot of stock to do so.
% On the other hand, deterministic heuristic have the lowest stocks but also the worst service level.
% Cover-sizes have the same variations: they are shorter for deterministic heuristic than for the other ones.


% Comparing results between undercapacitated lines ($L_0$ to $L_4$) and overcapacitated lines ($L_5$ and $L_6$) does not show clear difference on the behaviors of the heuristics.
% Lot-size and (2SA-$m$) heuristics remain the heuristics making more stocks but with a better service level and cover-size and deterministic heuristics make few stocks but have a bad service level.


% By staring at the values of the backorder cost, we can see that the values computed by method proposed in \cref{sec:PDP:numerical-experiments:drawing-realization-of-demand} are very small especially for small desired service level like 85\%.
% Thus, the method to compute the backorder is too optimistic and must be improved.
% A simple way might be to skew the method.
% A more sophisticated one might be to use extensions of the news-vendor problem like the multi-stage extension.



